(()=>{var e={657:e=>{e.exports=class{constructor(){this.currentHealth=500,this.maxHealth=500,this.currentAP=150,this.maxAP=150,this.attack=80,this.defense=25,this.magic=120,this.player=0}dealDamage(e){this.player=e;let t=Math.floor(100*Math.random());return console.log(`Random enemy number: ${t}`),t<50?this.attackOne.bind(this)():this.attackTwo.bind(this)()}attackOne(){let e=Math.floor(50*Math.random()),t=Math.floor(50*Math.random()),s=this.attack+e-t-this.player.defense;return s<1&&(s=1),this.player.currentHealth-s<0&&(s=this.player.currentHealth),console.log(`Enemy deals ${s} damage to player!`),this.playSound("magic-attack"),[s,this.player,this]}attackTwo(){if(this.currentAP<50)return this.attackOne.bind(this)();this.currentAP-=50;let e=Math.floor(50*Math.random()),t=Math.floor(50*Math.random()),s=this.magic+e-t-this.player.magic;return s<1&&(s=1),this.player.currentHealth-s<0&&(s=this.player.currentHealth),console.log(`Enemy deals ${s} damage to player!`),this.playSound("magic-critical-hit"),[s,this.player,this]}playSound(e,t=1){let s=document.getElementById(e);s.volume=t,s.play()}}},417:(e,t,s)=>{const i=s(507),n=s(657);e.exports=class{constructor(){this.backgroundCanvas=document.getElementById("battle-scene"),this.backgroundCTX=this.backgroundCanvas.getContext("2d"),this.playerCanvas=document.getElementById("player-canvas"),this.enemyCanvas=document.getElementById("enemy-canvas"),this.menuCanvas=document.getElementById("menu-canvas"),this.playerCTX=this.playerCanvas.getContext("2d"),this.enemyCTX=this.enemyCanvas.getContext("2d"),this.menuCTX=this.menuCanvas.getContext("2d"),this.player=new i,this.enemy=new n,this.playerHealthBar=document.getElementById("player-health-bar"),this.playerAPBar=document.getElementById("player-AP-bar"),this.enemyHealthBar=document.getElementById("enemy-health-bar"),this.enemyAPBar=document.getElementById("enemy-AP-bar"),this.messageDiv=document.getElementById("message-div"),this.infoDiv=document.getElementById("info-div"),this.executeCommandListener=this.executeCommand.bind(this),this.displayMenuInfoListener=this.displayMenuInfo.bind(this),this.executeAbilityListener=this.executeAbility.bind(this),this.displayAbilityInfoListener=this.displayAbilityInfo.bind(this),this.warriorSpritesheet=new Image,this.warriorSpritesheet.src="./assets/spritesheets/warrior_spritesheet.png"}styleBackground(e){this.backgroundCTX.drawImage(e,0,0,800,600)}styleMessageDiv(){this.messageDiv.style.position="absolute",this.messageDiv.style.top="50px",this.messageDiv.style.left="110px",this.messageDiv.innerHTML="Battle Start!"}message(e){this.messageDiv.innerHTML=e}reportDamage(e,t,s){this.messageDiv.innerHTML=e+` deals ${t} to `+s+"!"}reportDefeated(e){this.messageDiv.innerHTML=e+" has been defeated!"}styleInfoDiv(){this.infoDiv.style.position="absolute",this.infoDiv.style.top="100px",this.infoDiv.style.left="110px",this.infoDiv.style.display="none"}repositionInfoDiv(e,t){this.infoDiv.style.display="table-cell",this.infoDiv.style.left=`${e+5}px`,this.infoDiv.style.top=t-135+"px"}fillInfo(e){this.infoDiv.innerHTML=e}hideInfoDiv(){this.infoDiv.style.display="none"}stylePlayerCanvas(e){this.playerCanvas.style.position="absolute",this.playerCanvas.style.top="10px",this.playerCanvas.style.left="10px",this.playerCanvas.addEventListener("mousemove",this.displayPlayerInfo.bind(this)),this.playerCanvas.addEventListener("mouseout",this.hideInfoDiv.bind(this)),this.playerCTX.drawImage(e,14,713,43,55,200,250,86,110),this.updatePlayerBars()}updatePlayerBars(){this.playerHealthBar.style.position="absolute",this.playerHealthBar.style.top="200px",this.playerHealthBar.style.left="180px",this.playerHealthBar.value=this.player.currentHealth,this.playerHealthBar.max=this.player.maxHealth,this.playerAPBar.style.position="absolute",this.playerAPBar.style.top="220px",this.playerAPBar.style.left="180px",this.playerAPBar.value=this.player.currentAP,this.playerAPBar.max=this.player.maxAP}displayPlayerInfo(e){const t=e.clientX,s=e.clientY;this.isPointInsideRect(t,s,180,238,200,200)?(this.repositionInfoDiv(t,s),this.fillInfo(`\n                Health: ${this.player.currentHealth} / ${this.player.maxHealth}\n                <br>\n                AP: ${this.player.currentAP} / ${this.player.maxAP}\n                <br>\n                Attack: ${this.player.attack}\n                <br>\n                Defense: ${this.player.defense}\n                <br>\n                Magic: ${this.player.magic}   \n                `)):this.hideInfoDiv()}drawPlayerFrame(e,t,s,i){this.playerCTX.clearRect(0,0,this.playerCanvas.width,this.playerCanvas.width);const n=10+64*e,a=9+64*t;this.playerCTX.drawImage(this.warriorSpritesheet,n,a,55,55,s,i,110,110)}styleEnemyCanvas(e){this.enemyCanvas.style.position="absolute",this.enemyCanvas.style.top="10px",this.enemyCanvas.style.left="410px",this.enemyCanvas.addEventListener("mousemove",this.displayEnemyInfo.bind(this)),this.enemyCanvas.addEventListener("mouseout",this.hideInfoDiv.bind(this)),this.enemyCTX.drawImage(e,9,10,25,31,200,265,75,93),this.updateEnemyBars()}updateEnemyBars(){this.enemyHealthBar.style.position="absolute",this.enemyHealthBar.style.top="210px",this.enemyHealthBar.style.left="570px",this.enemyHealthBar.value=this.enemy.currentHealth,this.enemyHealthBar.max=this.enemy.maxHealth,this.enemyAPBar.style.position="absolute",this.enemyAPBar.style.top="230px",this.enemyAPBar.style.left="570px",this.enemyAPBar.value=this.enemy.currentAP,this.enemyAPBar.max=this.enemy.maxAP}displayEnemyInfo(e){const t=e.clientX,s=e.clientY;this.isPointInsideRect(t,s,571,248,175,200)?(this.repositionInfoDiv(t,s),this.fillInfo(`\n                Health: ${this.enemy.currentHealth} / ${this.enemy.maxHealth}\n                <br>\n                AP: ${this.enemy.currentAP} / ${this.enemy.maxAP}\n                <br>\n                Attack: ${this.enemy.attack}\n                <br>\n                Defense: ${this.enemy.defense}\n                <br>\n                Magic:  ${this.enemy.magic}\n                `)):this.hideInfoDiv()}styleDefaultMenu(e){this.menuCanvas.style.position="absolute",this.menuCanvas.style.top="450px",this.menuCanvas.style.left="110px",this.menuCTX.fillStyle="blue",this.menuCTX.fillRect(0,0,this.menuCanvas.width,this.menuCanvas.height),this.menuCanvas.removeEventListener("mousemove",this.displayAbilityInfoListener),this.menuCanvas.removeEventListener("click",this.executeAbilityListener),this.menuCanvas.addEventListener("mousemove",this.displayMenuInfoListener),this.menuCanvas.addEventListener("mouseout",this.hideInfoDiv.bind(this)),this.menuCanvas.addEventListener("click",this.executeCommandListener);let t=514,s=519;this.menuCTX.drawImage(e,s,0,t,t,25,25,100,100),this.menuCTX.drawImage(e,0,0,t,t,175,25,100,100),this.menuCTX.drawImage(e,s,s,t,t,325,25,100,100),this.menuCTX.drawImage(e,0,s,t,t,475,25,100,100)}styleAbilityMenu(){this.hideInfoDiv(),this.menuCTX.clearRect(0,0,this.menuCanvas.width,this.menuCanvas.height),this.menuCTX.fillRect(0,0,this.menuCanvas.width,this.menuCanvas.height),this.removeMenuListeners(),this.menuCanvas.addEventListener("click",this.executeAbilityListener),this.menuCanvas.addEventListener("mousemove",this.displayAbilityInfoListener),this.menuCTX.drawImage(this.basicIconSpritesheet,1039,0,514,514,475,25,100,100),this.menuCTX.drawImage(this.healImage,0,0,512,509,175,25,100,100)}addMenuListeners(){this.menuCanvas.addEventListener("click",this.executeCommandListener),this.menuCanvas.addEventListener("mousemove",this.displayMenuInfoListener)}removeMenuListeners(){this.menuCanvas.removeEventListener("click",this.executeCommandListener),this.menuCanvas.removeEventListener("mousemove",this.displayMenuInfoListener)}displayMenuInfo(e){const t=e.clientX,s=e.clientY,i=100,n=478;this.isPointInsideRect(t,s,137,n,i,i)?(this.repositionInfoDiv(t,s),this.fillInfo(`Deal ~${this.player.attack-this.enemy.defense} damage <br> to the enemy.`)):this.isPointInsideRect(t,s,287,n,i,i)?(this.repositionInfoDiv(t,s),this.fillInfo("Use special abilities <br> These typically cost Ability Points. (AP)")):this.isPointInsideRect(t,s,437,n,i,i)?(this.repositionInfoDiv(t,s),this.fillInfo("Use items to aid you <br> in battle. <br> (If you HAD any!)")):this.isPointInsideRect(t,s,587,n,i,i)?(this.repositionInfoDiv(t,s),this.fillInfo("Boost your defense <br> by 50% for one turn.")):this.hideInfoDiv()}executeCommand(e){const t=e.clientX,s=e.clientY,i=100,n=480;if(this.isPointInsideRect(t,s,137,n,i,i)){this.menuCanvas.removeEventListener("click",this.executeCommandListener);let e=this.player.dealDamage(this.enemy);if(this.enemy.currentHealth-=e,this.reportDamage("Player",e,"Enemy"),this.updatePlayerBars(),this.updateEnemyBars(),console.log(`Enemy hp: ${this.enemy.currentHealth}`),this.enemy.currentHealth<=0){let e=document.getElementById("victory");e.volume=.5,this.pauseSound("battle-theme"),setTimeout(function(){this.reportDefeated("Enemy")}.bind(this),1e3),setTimeout((()=>{e.play()}),500)}else setTimeout(this.enemyTurn.bind(this),1e3)}else this.isPointInsideRect(t,s,287,n,i,i)?this.styleAbilityMenu():this.isPointInsideRect(t,s,437,n,i,i)?(this.playSound("cancel",.8),console.log("ITEMS")):this.isPointInsideRect(t,s,587,n,i,i)&&(this.menuCanvas.removeEventListener("click",this.executeCommandListener),this.player.defense=1.5*this.player.defense,this.player.magic=1.5*this.player.magic,this.message("Defense boosted for one turn!"),this.playSound("defense",.2),setTimeout(this.enemyTurn.bind(this,"playerDefends"),1e3))}displayAbilityInfo(e){const t=e.clientX,s=e.clientY,i=100,n=478;this.isPointInsideRect(t,s,137,n,i,i)||(this.isPointInsideRect(t,s,287,n,i,i)?(this.repositionInfoDiv(t,s),this.fillInfo(`Recover ~${this.player.magic+30} health <br> Costs 30 AP.`)):this.isPointInsideRect(t,s,437,n,i,i)||(this.isPointInsideRect(t,s,587,n,i,i)?(this.repositionInfoDiv(t,s),this.fillInfo("Go back <br> to the main command menu.")):this.hideInfoDiv()))}executeAbility(e){const t=e.clientX,s=e.clientY,i=100,n=480;if(this.isPointInsideRect(t,s,137,n,i,i));else if(this.isPointInsideRect(t,s,287,n,i,i)){this.styleDefaultMenu(this.basicIconSpritesheet),this.menuCanvas.removeEventListener("click",this.executeCommandListener);let e=this.player.heal();this.player=e[0],"Not enough AP!"===e[1]||"Health is already full!"===e[1]?(this.message(e[1]),this.updatePlayerBars(),setTimeout((()=>{this.menuCanvas.addEventListener("click",this.executeCommandListener)}),1200)):(this.message(e[1]),this.updatePlayerBars(),setTimeout(this.enemyTurn.bind(this),1e3))}else this.isPointInsideRect(t,s,437,n,i,i)||this.isPointInsideRect(t,s,587,n,i,i)&&this.styleDefaultMenu(this.basicIconSpritesheet)}isPointInsideRect(e,t,s,i,n,a){return s<=e&&s+n>=e&&i<=t&&i+a>=t}playSound(e,t=1){let s=document.getElementById(e);s.volume=t,s.play()}pauseSound(e){document.getElementById(e).pause()}cancelAnimation(e){cancelAnimationFrame(e)}enemyTurn(e){let t=this.enemy.dealDamage(this.player),s=t[0];if(this.player=t[1],this.enemy=t[2],this.player.currentHealth-=s,this.reportDamage("Enemy",s,"Player"),this.updatePlayerBars(),this.updateEnemyBars(),console.log(`Player hp: ${this.player.currentHealth}`),"playerDefends"===e&&(this.player.defense=this.player.defense/1.5,this.player.magic=this.player.magic/1.5),this.player.currentHealth<=0){let e=document.getElementById("game-over");e.volume=.5,this.pauseSound("battle-theme"),setTimeout(function(){this.reportDefeated("Player")}.bind(this),1e3),setTimeout((()=>{e.play()}),500)}else setTimeout(function(){this.menuCanvas.addEventListener("click",this.executeCommandListener)}.bind(this),1e3)}}},507:e=>{e.exports=class{constructor(){this.currentHealth=400,this.maxHealth=400,this.currentAP=100,this.maxAP=100,this.attack=100,this.defense=50,this.magic=30}dealDamage(e){let t=Math.floor(50*Math.random()),s=Math.floor(50*Math.random()),i=this.attack+t-s-e.defense;return i<1&&(i=1),e.currentHealth-i<0&&(i=e.currentHealth),console.log(`Player deals ${i} damage to enemy!`),this.playSound("physical-critical-hit",.5),i}heal(){if(this.currentAP<30)return this.playSound("cancel",.9),[this,"Not enough AP!"];if(this.currentHealth===this.maxHealth)return this.playSound("cancel",.9),[this,"Health is already full!"];this.currentAP-=30;let e=Math.floor(50*Math.random()),t=Math.floor(20*Math.random()),s=this.magic+e-t;return this.currentHealth+=s,this.currentHealth>this.maxHealth&&(this.currentHealth=this.maxHealth),this.playSound("heal"),[this,`Player recovered ${s} health!`]}playSound(e,t=1){let s=document.getElementById(e);s.volume=t,s.play()}}}},t={};function s(i){var n=t[i];if(void 0!==n)return n.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,s),a.exports}(()=>{const e=s(417);s(507),s(657),document.addEventListener("DOMContentLoaded",(()=>{const t=new e;window.g=t;const s=new Image;s.src="./assets/general_assets/background.png",s.onload=function(){t.styleBackground(s)};const i=new Image;i.src="./assets/spritesheets/warrior_spritesheet.png",i.onload=function(){t.stylePlayerCanvas(i)};const n=new Image;n.src="./assets/spritesheets/mage_spritesheet.png",n.onload=function(){t.styleEnemyCanvas(n)};const a=new Image;a.src="./assets/spritesheets/basic_icon_spritesheet.png",a.onload=function(){t.styleDefaultMenu(a),t.styleMessageDiv(),t.styleInfoDiv(),t.basicIconSpritesheet=a;let e=new Image;e.src="./assets/ability_icons/heal.png",t.healImage=e},document.getElementById("battle-theme").volume=.5}))})()})();